<html>
<head>
<style>
body {
  min-width:357px;
  overflow-x:hidden;
}

img {
  margin:5px;
  border:2px solid black;
  vertical-align:middle;
  width:75px;
  height:75px;
}
</style>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script>

function processPulls(pulls) {
  var badge_text = (pulls.length == 0 ? '' : pulls.length.toString());
  chrome.browserAction.setBadgeText({text: badge_text});
}

function fetchPullRequests(owner, repo, onResult) {
  $.ajax({
    url: "https://" + localStorage.githubHost + '/api/v3/repos/' + owner + '/' + repo + '/pulls',
    success: onResult
  });  
}

function think() {
  fetchPullRequests("atl", "ds-agent", processPulls);  
  setTimeout("think()", 1000 * 60);
}

$(document).ready(function() {
  chrome.browserAction.setBadgeBackgroundColor({color:[0xC4, 0, 0x22, 255]});
  think();  
})


</script>
</head>
<body>
</body>
</html>